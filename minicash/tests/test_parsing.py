import unittest
import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.realpath(__file__))))
from utils.parsers import isValidLedger
from utils.parsers import isValidLedgerResponseFormat

class TestValidLedger(unittest.TestCase):
    
    def testValidLedger(self):
        validLedgers = [
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':99999999, '0FC085CAAB8059F0_802809':99999999, '8D972AA78B46CBF7_124625':100000002},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':0, '0FC085CAAB8059F0_802809':50000000, '8D972AA78B46CBF7_124625':250000000},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {},
            {'8D972AA78B46CBF7_124625':100000000}
                ]

        invalidLedgers = [
            {'CC0504FD53A5A5E7_2793272':100000040, 'C4ED6700DFB2A1DF_2514606':99999999, '0FC085CAAB8059F0_802809':99999999, '8D972AA78B46CBF7_124625':100000002},
            {'CC0504FD53A5A5E7_279327':100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_27931000000002':100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':-100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':None, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':True, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {343351000000004:100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000, True:100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000.454, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000.0, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':'jdfkjldjf', '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E6_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '0FC085CAAB8059F0_802809':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':100000000.3432, '1BE0B920ABB6D44A_3208670':100000000, '8D972AA78B46CBF7_124625':100000000},
            {'CC0504FD53A5A5E7_2793272':100000000, 'C4ED6700DFB2A1DF_2514606':100000000, '1BE0B900ABB6D44A_320860':100000000, '8D972AA78B46CBF7_124625':-100000000},
            'kdfjldkjfkl', 10000000042434, True
                ]

            
        for v in validLedgers:
            self.assertFalse(isValidLedger(v))
        for v in invalidLedgers:
            self.assertTrue(isValidLedger(v))

    def testValidResponseFormat(self):
        validResponses = [
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'34224324', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{}, 'Type': 'RESP_LEDGER'}
        ]

        invalidResponses = [
            {'Leder':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Sigatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B4ZCBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER', 'extra_thing':'dfjdlfkj'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Hype': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':10000000044}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', 49:'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'klfjldj', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': {}},
            '{}',
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':31000000004, 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESP_LEDGER'},
            {'Ledger':{}, 'Signatures':{'8D972AA78B46CBF7':'dkfjldjk', 'CC0504FD53A5A5E7':'', '3EE3FD7A50CBD975':'kdjfljdklj'}, 'Type': 'RESPLEDGER'}
        ]

        for v in validResponses:
            self.assertFalse(isValidLedgerResponseFormat(v))
        for v in invalidResponses:
            self.assertTrue(isValidLedgerResponseFormat(v))


if __name__ == '__main__':
    unittest.main()
